<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GIF Editor üé®</title>
  
  <!-- Cropper.js -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script src="https://unpkg.com/gifuct-js/dist/gifuct.min.js"></script>
  
  <!-- Global Theme & Editor Specifics -->
  <link rel="stylesheet" href="/static/gif_editor.css">
</head>
<body>

<div class="container">
  
  <div class="header-row">
    <button onclick="window.location.href='/'" class="back-btn">‚¨ÖÔ∏è Back</button>
    <h1>GIF Studio üé®</h1>
    <div style="width: 80px;"></div> <!-- Spacer for centering -->
  </div>

  <div class="dashboard-grid">
    
    <!-- LEFT COLUMN: Editor Tools -->
    <div class="editor-controls">
      
      <!-- Step 1: Upload & Crop -->
      <div class="glass-panel">
        <h2>1. Upload & Crop</h2>
        <div class="file-upload-wrapper">
          <input type="file" id="gif-input" accept="image/gif" class="custom-file-input">
        </div>
        
        <div class="crop-container">
          <img id="crop-image" src="" alt="Upload a GIF to start">
        </div>
        
        <button id="apply-crop-btn" class="primary-btn full-width">‚úÇÔ∏è Apply Crop</button>
      </div>

      <!-- Step 2: Effects -->
      <div class="glass-panel">
        <h2>2. Effects</h2>
        
        <div class="slider-group">
          <label>Resolution <span id="res-val">(128)</span></label>
          <input type="range" id="resolution" min="32" max="256" value="128" oninput="updateVal('res-val', this.value)">
        </div>

        <div class="slider-group">
          <label>Brightness <span id="bright-val">(100%)</span></label>
          <input type="range" id="brightness" min="0" max="200" value="100" oninput="updateVal('bright-val', this.value + '%')">
        </div>

        <div class="slider-group">
          <label>Saturation <span id="sat-val">(100%)</span></label>
          <input type="range" id="saturation" min="0" max="200" value="100" oninput="updateVal('sat-val', this.value + '%')">
        </div>

        <div class="checkbox-row">
          <label class="checkbox-container">
            <input type="checkbox" id="interpolation" checked>
            <span class="checkmark"></span>
            Interpolation
          </label>
          
          <label class="checkbox-container">
            <input type="checkbox" id="temporal-smooth">
            <span class="checkmark"></span>
            Smooth
          </label>
        </div>

        <button id="apply-effects-btn" class="full-width">‚ú® Apply Effects</button>
      </div>

      <!-- Step 3: Playback & Save -->
      <div class="glass-panel">
        <h2>3. Export</h2>
        
        <div class="control-row">
          <button id="play-btn">‚ñ∂ Play</button>
          <button id="pause-btn">‚è∏ Pause</button>
        </div>
        
        <div class="input-group">
          <label>FPS:</label>
          <input type="number" id="fps" value="15" min="1" max="60">
        </div>

        <div class="save-section">
          <input type="text" id="gif-name" placeholder="Name your effect..." class="text-input">
          <button id="save-gif-btn" class="primary-btn">üíæ Save to Tree</button>
        </div>
      </div>

    </div>

    <!-- RIGHT COLUMN: Preview (Sticky) -->
    <div class="preview-column">
      <div class="glass-panel sticky-panel">
        <h2>LED Preview</h2>
        <div class="canvas-wrapper">
          <canvas id="preview-canvas"></canvas>
        </div>
        <p class="text-muted" style="text-align:center; margin-top:10px;">
          This shows how the GIF maps to your LEDs.
        </p>
      </div>
    </div>

  </div>
</div>

<script src="/static/gif_cropper.js"></script>
<script>
  // Simple helper to update slider labels
  function updateVal(id, val) { document.getElementById(id).innerText = `(${val})`; }
</script>
</body>
</html>